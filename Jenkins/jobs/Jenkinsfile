import groovy.json.JsonSlurperClassic

def jsonParse(def json){
    new groovy.json.JsonSlurperClassic().parseText(json)
}

pipeline {

    agent any
    stages {
        stage('Obtener Usuario SSH') {
            steps {
                withCredentials([sshUserPrivateKey(credentialsId: 'PruebaGit', keyFileVariable: 'SSH_KEY', usernameVariable: 'SSH_USER')]) {
                    echo "Usuario SSH: ${SSH_USER}"
                }
            }
        }
    }

    post {
        always {
            deleteDir() // limpia workspace en B
            sh "echo 'Fase Always'"
        }
        success {
            sh "echo 'Fase Success'"
        }
        failure {
            sh "echo 'Fase Failure'"
        }
    }
}
